!function(){
    /*!
     * JSTable v2.1
     */
    const t={sortable:!0,searchable:!0,classes:{top:"dt-top",info:"dt-info",input:"dt-input",table:"dt-table",bottom:"dt-bottom",search:"dt-search",sorter:"dt-sorter",wrapper:"dt-wrapper",dropdown:"dt-dropdown",ellipsis:"dt-ellipsis",selector:"dt-selector",container:"dt-container",loading:"dt-loading",message:"dt-message",iconClear:"icon-clear",faIconClear:"fa-times"},labels:{placeholder:"Search...",noRows:"No entries found",info:"Showing {start} to {end} of {rows} entries",loading:"Loading...",infoFiltered:"Showing {start} to {end} of {rows} entries (filtered from {rowsTotal} entries)"},layout:{top:"{search}",bottom:"{info}"},serverSide:!1,deferLoading:null,ajax:null,ajaxParams:{},queryParams:{search:"search",sortColumn:"sortColumn",sortDirection:"sortDirection"},addQueryParams:!0,rowAttributesCreator:null,searchDelay:null,method:"GET"};class e{constructor(t){this.element=t,this.body=this.element.tBodies[0],this.head=this.element.tHead,this.rows=[];for(var e=Array.from(this.element.rows),a=0;a<e.length;a++)this.rows.push(new s(e[a],e[a].parentNode.nodeName,a,this.rows[a-1]));this.dataRows=this._getBodyRows(),this.header=this._getHeaderRow()}_getBodyRows(){return this.rows.filter((function(t){return!t.isHeader&&!t.isFooter}))}_getHeaderRow(){return this.rows.find((function(t){return t.isHeader}))}getColumnCount(){return this.header.getColumnCount()}getFooterRow(){return this.rows.find((function(t){return t.isFooter}))}}class s{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,i=Array.from(t.cells);r?(this.cells=[],r.cells.forEach((t=>{t.attributes.rowspan>1?(t.decreaseRowSpan(),this.cells.push(t)):i.length&&this.cells.push(new a(i.shift()))}))):this.cells=i.map((function(t){return new a(t)})),this.cells=this.cells.reduce(((t,e,s,a)=>{if(1==e.attributes.colspan)t.push(e);else{let s=Array(Number(e.attributes.colspan)).fill(e).map((t=>(t.attributes.colspan=1,t)));t=t.concat(s)}return t}),[]),this.d=this.cells.length,this.isHeader="THEAD"===e,this.isFooter="TFOOT"===e,this.visible=!0,this.rowID=s;var n=this;this.attributes={},[...t.attributes].forEach((function(t){n.attributes[t.name]=t.value}))}getCells(){return Array.from(this.cells)}getColumnCount(){return this.cells.length}getCell(t){return this.cells[t]}getCellTextContent(t){return this.getCell(t).getTextContent()}static createFromData(t){let e=document.createElement("tr");if(t.hasOwnProperty("data")){if(t.hasOwnProperty("attributes"))for(const s in t.attributes)e.setAttribute(s,t.attributes[s]);t=t.data}return t.forEach((function(t){let s=document.createElement("td");if(s.innerHTML=t&&t.hasOwnProperty("data")?t.data:t,t&&t.hasOwnProperty("attributes"))for(const e in t.attributes)s.setAttribute(e,t.attributes[e]);e.appendChild(s)})),new s(e)}getFormatted(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=document.createElement("tr");var a=this;for(let t in this.attributes)s.setAttribute(t,this.attributes[t]);let r=e?e.call(this,this.getCells()):{};for(const t in r)s.setAttribute(t,r[t]);const i=this.getCells();for(var n=0;n<i.length;n++){let e=i[n];var o=document.createElement("td");o.innerHTML=e.getInnerHTML(),t.hasOwnProperty(n)&&(o.innerHTML=t[n].call(a,e.getElement(),n)),e.classes.length>0&&(o.className=e.classes.join(" "));for(let t in e.attributes)o.setAttribute(t,e.attributes[t]);let r=i.filter((t=>t===e)).length;r>1&&n>i.indexOf(e)||(r>1&&n==i.indexOf(e)&&o.setAttribute("colspan",r),s.appendChild(o))}return a.cells=a.cellsOrig,a.cellsOrig=null,s}setCellClass(t,e){this.cells[t].addClass(e)}}class a{constructor(t){this.textContent=t.textContent,this.innerHTML=t.innerHTML,this.className=t.className,this.hasSortable=t.hasAttribute("data-sortable"),this.isSortable=this.hasSortable?"true"===t.getAttribute("data-sortable"):null,this.hasSort=t.hasAttribute("data-sort"),this.sortDirection=t.getAttribute("data-sort"),this.classes=[],this.attributes={};var e=this;[...t.attributes].forEach((function(t){e.attributes[t.name]=t.value})),void 0===e.attributes.rowspan?e.addAttribute("rowspan",1):e.addAttribute("rowspan",Number(e.attributes.rowspan)),void 0===e.attributes.colspan?e.addAttribute("colspan",1):e.addAttribute("colspan",Number(e.attributes.colspan))}getElement(){return this.element}getTextContent(){return this.textContent}getInnerHTML(){return this.innerHTML}setClass(t){this.className=t}setSortable(t){this.isSortable=t}addClass(t){this.classes.push(t)}removeClass(t){this.classes.indexOf(t)>=0&&this.classes.splice(this.classes.indexOf(t),1)}addAttribute(t,e){this.attributes[t]=e}decreaseRowSpan(){this.attributes.rowspan>1&&this.addAttribute("rowspan",this.attributes.rowspan-1)}}window.JSTable=class{constructor(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=s;"string"==typeof s&&(r=document.querySelector(s)),null!==r&&(this.config=this._merge(t,a),this.table=new e(r),void 0!==this.table.header?(this.currentPage=1,this.columnRenderers=[],this.columnsNotSearchable=[],this.searchQuery=null,this.sortColumn=null,this.sortDirection="asc",this.isSearching=!1,this.dataCount=null,this.filteredDataCount=null,this.searchTimeout=null,this._build(),this._buildColumns(),this.update(null===this.config.deferLoading),this._bindEvents(),this._emit("init"),this._parseQueryParams()):console.warn("Table has no header, exiting"))}_build(){let t=this.config;this.wrapper=document.createElement("div"),this.wrapper.className=t.classes.wrapper;var e=["<div class='",t.classes.top,"'>",t.layout.top,"</div>","<div class='",t.classes.container,"'>","<div class='",t.classes.loading," hidden'>",t.labels.loading,"</div>","</div>","<div class='",t.classes.bottom,"'>",t.layout.bottom,"</div>"].join("");if(e=e.replace("{info}","<div class='"+t.classes.info+"'></div>"),t.searchable){var s=["<div class='",t.classes.search,"'>","<input class='",t.classes.input,"' placeholder='",t.labels.placeholder,"' type='text'>","<span class='",t.classes.iconClear,"'><i class='fa ",t.classes.faIconClear,"' title=''></i></span>","</div>"].join("");e=e.replace(/\{search\}/g,s)}else e=e.replace(/\{search\}/g,"");this.table.element.classList.add(t.classes.table),this.wrapper.innerHTML=e,this.table.element.parentNode.replaceChild(this.wrapper,this.table.element),this.wrapper.querySelector("."+t.classes.container).appendChild(this.table.element),this._updateInfo()}async update(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var e=this;let s=e.wrapper.querySelector(" ."+e.config.classes.loading);if(s.classList.remove("hidden"),this.table.header.getCells().forEach((function(t,s){let a=e.table.head.rows[0].cells[s];a.innerHTML=t.getInnerHTML(),t.classes.length>0&&(a.className=t.classes.join(" "));for(let e in t.attributes)"class"!=e&&a.setAttribute(e,t.attributes[e]);a.setAttribute("data-sortable",t.isSortable)})),t)return this.getPageData().then((function(t){if(e.table.element.classList.remove("hidden"),e.table.body.innerHTML="",t.length){let s=Array(t[0].cells.length).fill(0);t.reduceRight(((t,a,r,i)=>{let n=[];for(var o=0;o<a.cells.length;o++){let t=a.cells[o];t==(r>0?i[r-1].cells[o]:void 0)?s[o]+=1:(t.addAttribute("rowspan",s[o]+1),s[o]=0,n.push(t))}let l=a;return l.cellsOrig=l.cells,l.cells=n,t.push(l.getFormatted(e.columnRenderers,e.config.rowAttributesCreator)),t}),[]).reverse().forEach((function(t){e.table.body.appendChild(t)}))}s.classList.add("hidden")})).then((function(){e.getDataCount()<=0&&(e.wrapper.classList.remove("search-results"),e.setMessage(e.config.labels.noRows)),e._emit("update")})).then((function(){e._updateInfo()}));e.table.element.classList.remove("hidden"),e.table.body.innerHTML="",this.getDataCount()<=0&&(e.wrapper.classList.remove("search-results"),e.setMessage(e.config.labels.noRows)),this._getData().forEach((function(t){e.table.body.appendChild(t.getFormatted(e.columnRenderers,e.config.rowAttributesCreator))})),s.classList.add("hidden")}_updateInfo(){let t=this.wrapper.querySelector(" ."+this.config.classes.info),e=this.isSearching?this.config.labels.infoFiltered:this.config.labels.info;if(t&&e.length){var s=e.replace("{rows}",this.getDataCount()).replace("{rowsTotal}",this.getDataCountTotal());t.innerHTML=s}}_getData(){return this._emit("getData",this.table.dataRows),this.table.dataRows.filter((function(t){return t.visible}))}_fetchData(){var t=this;let e={searchQuery:this.searchQuery,sortColumn:this.sortColumn,sortDirection:this.sortDirection,datatable:1};e=Object.assign({},this.config.ajaxParams,e);let a=this.config.ajax+"?"+this._queryParams(e);return fetch(a,{method:this.config.method,credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){return t._emit("fetchData",e),t.dataCount=e.recordsTotal,t.filteredDataCount=e.recordsFiltered,e.data})).then((function(t){let e=[];return t.forEach((function(t){e.push(s.createFromData(t))})),e})).catch((function(t){console.error(t)}))}_queryParams(t){return Object.keys(t).map((e=>encodeURIComponent(e)+"="+encodeURIComponent(t[e]))).join("&")}getDataCount(){return this.isSearching?this.getDataCountFiltered():this.getDataCountTotal()}getDataCountFiltered(){return this.config.serverSide?this.filteredDataCount:this._getData().length}getDataCountTotal(){return this.config.serverSide?null!==this.config.deferLoading?this.config.deferLoading:this.dataCount:this.table.dataRows.length}getPageData(){return this.config.serverSide?this._fetchData():Promise.resolve(this._getData())}async search(t){var e=this;if(this.searchQuery===t.toLowerCase())return!1;if(this.searchQuery=t.toLowerCase(),this.config.searchDelay){if(this.searchTimeout)return!1;this.searchTimeout=setTimeout((function(){e.searchTimeout=null}),this.config.searchDelay)}return this.currentPage=1,this.isSearching=!0,this.searchQuery.length?(this.config.serverSide||this.table.dataRows.forEach((function(t){t.visible=!1,e.searchQuery.split(" ").reduce((function(s,a){var r;let i=t.getCells();return i=i.filter((function(t,s){if(e.columnsNotSearchable.indexOf(s)<0)return!0})),r=i.some((function(t,e){if(t.getTextContent().toLowerCase().indexOf(a)>=0)return!0})),s&&r}),!0)&&(t.visible=!0)})),this.wrapper.classList.add("search-results"),this.update().then((function(){e._emit("search",t)}))):(this.table.dataRows.forEach((function(t){t.visible=!0})),this.isSearching=!1,e.wrapper.classList.remove("search-results"),e.update(),!1)}sort(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var a=this;if(this.sortColumn=t||0,this.sortDirection=e,this.sortColumn<0||this.sortColumn>this.table.getColumnCount()-1)return!1;var r=this.table.header.getCell(this.sortColumn),i=this.table.dataRows;this.table.header.getCells().forEach((function(t){t.removeClass("asc"),t.removeClass("desc")})),r.addClass(this.sortDirection),this.config.serverSide||(i=i.sort((function(t,e){var s=t.getCellTextContent(a.sortColumn).toLowerCase(),r=e.getCellTextContent(a.sortColumn).toLowerCase();s=s.replace(/(\$|\,|\s|%|^-$|^\/$)/g,""),r=r.replace(/(\$|\,|\s|%|^-$|^\/$)/g,""),s=isNaN(s)||""===s?s:parseFloat(s),r=isNaN(r)||""===r?r:parseFloat(r),""===s&&""!==r||!isNaN(s)&&isNaN(r)?"asc"===a.sortDirection?1:-1:""!==s&&""===r||isNaN(s)&&!isNaN(r)?"asc"===a.sortDirection?-1:1:"asc"===a.sortDirection?s===r?0:s>r?1:-1:s===r?0:s<r?1:-1})),this.table.dataRows=i),this.config.serverSide&&s||this.update(),this._emit("sort",this.sortColumn,this.sortDirection)}_setQueryParam(t,e){if(!this.config.addQueryParams)return;const s=new URL(window.location.href);s.searchParams.set(this.config.queryParams[t],e),window.history.replaceState(null,null,s)}_bindEvents(){var t=this;this.wrapper.addEventListener("click",(function(e){var s=e.target;if("TH"===s.nodeName&&s.hasAttribute("data-sortable")){if("false"===s.getAttribute("data-sortable"))return!1;e.preventDefault();let a=s.classList.contains("asc")?"desc":"asc";t.sort(s.cellIndex,a),t._setQueryParam("sortColumn",s.cellIndex),t._setQueryParam("sortDirection",a)}})),this.config.searchable&&(this.wrapper.addEventListener("keyup",(function(e){"INPUT"===e.target.nodeName&&e.target.classList.contains(t.config.classes.input)&&(e.preventDefault(),t.search(e.target.value),t._setQueryParam("search",e.target.value))})),this.wrapper.addEventListener("click",(function(e){if("I"===e.target.nodeName&&e.target.classList.contains(t.config.classes.faIconClear)){e.preventDefault();let s=this.getElementsByClassName("dt-input")[0];s.value="",s.focus(),t.search(""),t._setQueryParam("search","")}})))}on(t,e){this.events=this.events||{},this.events[t]=this.events[t]||[],this.events[t].push(e)}off(t,e){this.events=this.events||{},t in this.events!=!1&&this.events[t].splice(this.events[t].indexOf(e),1)}_emit(t){if(this.events=this.events||{},t in this.events!=!1)for(var e=0;e<this.events[t].length;e++)this.events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}setMessage(t){var e=this.table.getColumnCount(),s=document.createElement("tr");s.innerHTML='<td class="'+this.config.classes.message+'" colspan="'+e+'">'+t+"</td>",this.table.body.innerHTML="",this.table.body.appendChild(s)}_buildColumns(){var t=this;let e=null,s=null;this.config.columns&&this.config.columns.forEach((function(a){isNaN(a.select)||(a.select=[a.select]),a.select.forEach((function(r){var i=t.table.header.getCell(r);if(void 0!==i){if(a.hasOwnProperty("render")&&"function"==typeof a.render&&(t.columnRenderers[r]=a.render),a.hasOwnProperty("sortable")){let r=!1;i.hasSortable?r=i.isSortable:(r=a.sortable,i.setSortable(r)),r&&(i.addClass(t.config.classes.sorter),a.hasOwnProperty("sort")&&1===a.select.length&&(e=a.select[0],s=a.sort))}a.hasOwnProperty("searchable")&&(i.addAttribute("data-searchable",a.searchable),!1===a.searchable&&t.columnsNotSearchable.push(r))}}))})),this.table.header.getCells().forEach((function(a,r){null===a.isSortable&&a.setSortable(t.config.sortable),a.isSortable&&(a.addClass(t.config.classes.sorter),a.hasSort&&(e=r,s=a.sortDirection))})),null!==e&&t.sort(e,s,!0)}_merge(t,e){var s=this;return Object.keys(t).forEach((function(a){!e.hasOwnProperty(a)||"object"!=typeof e[a]||e[a]instanceof Array||null===e[a]?e.hasOwnProperty(a)||(e[a]=t[a]):s._merge(t[a],e[a])})),e}async _parseQueryParams(){const t=new URLSearchParams(window.location.search);let e=t.get(this.config.queryParams.perPage);if(e){e=parseInt(e),this.config.perPage=e,this.wrapper.querySelectorAll("."+this.config.classes.selector).forEach((function(t){t.querySelectorAll("option").forEach((t=>t.removeAttribute("selected"))),t.value=e,t.querySelector(`option[value='${e}']`).setAttribute("selected","")})),this.update()}let s=t.get(this.config.queryParams.search);if(s){this.wrapper.querySelectorAll("."+this.config.classes.input).forEach((function(t){t.value=s})),await this.search(s)}let a=t.get(this.config.queryParams.sortColumn);if(a){a=parseInt(a);let e=t.get(this.config.queryParams.sortDirection);e=null==e?"asc":e,this.sort(a,e)}}}}();